import os
from gensim.models import word2vec
from gensim.models import KeyedVectors
from pprint import pprint


def main():
    source_path = '../chapter09/knock81_out'.replace('/', os.sep)
    model_path = 'knock90.model'
    if os.path.exists(model_path):
        wv = KeyedVectors.load(model_path)
    else:
        sentences = word2vec.LineSentence(source_path)
        model = word2vec.Word2Vec(sentences, size=300)
        model.wv.save(model_path)
        wv = model.wv

    print('knock86\n', wv['United_States'])
    print('knock87\n', wv.similarity('United_States', 'U.S'))
    print('knock88')
    pprint(wv.most_similar('England'))
    print('knock89')
    vec = wv['Spain'] - wv['Madrid'] + wv['Athens']
    pprint(wv.most_similar([vec]))


if __name__ == '__main__':
    main()


''' 問
90. word2vecによる学習

81で作成したコーパスに対してword2vecを適用し，単語ベクトルを学習せよ．
さらに，学習した単語ベクトルの形式を変換し，86-89のプログラムを動かせ．
'''

''' 実行結果
C:\Users\qavio\Anaconda3\lib\site-packages\gensim\utils.py:1209: UserWarning: detected Windows; aliasing chunkize to chunkize_serial
  warnings.warn("detected Windows; aliasing chunkize to chunkize_serial")
knock86
 [ -1.20743847e+00  -4.09069099e-02   3.11730713e-01   1.06156838e+00
  -1.27329779e+00   3.85945737e-01  -9.29421127e-01  -1.28361419e-01
  -6.73101783e-01  -4.68490779e-01  -7.93466046e-02   8.01858157e-02
  -7.18795002e-01  -8.26777697e-01  -7.23744214e-01   1.06207184e-01
  -7.58969665e-01   4.81809527e-01  -2.94280857e-01   6.82228148e-01
  -9.05511439e-01  -1.34993985e-01   4.03636724e-01  -1.20054948e+00
   3.41515303e-01   7.65819669e-01   7.74051368e-01   3.24406236e-01
  -1.00606918e+00  -6.78677671e-03   1.19665098e+00   5.96221723e-02
  -5.57229519e-01  -7.27872491e-01   1.20798036e-01  -1.61666727e+00
  -9.55485404e-01   9.33806837e-01  -4.15508509e-01   2.03333831e+00
   7.42480695e-01  -6.60123348e-01   1.06887805e+00  -4.81514305e-01
  -4.25134122e-01  -1.17975867e+00   9.71837521e-01  -5.80230892e-01
   9.13508773e-01  -6.48974240e-01   7.92283416e-01  -4.71223295e-01
  -4.60638940e-01   3.06943208e-01   1.42116952e+00  -1.37133345e-01
  -2.30932117e+00  -6.81905389e-01  -1.42281997e+00   7.43287385e-01
  -1.15099168e+00  -7.44969070e-01  -6.82857037e-02   6.18982375e-01
   1.75445259e-01   4.62229997e-01   2.67726630e-01   1.43190384e+00
   3.29384178e-01   1.58325970e+00  -1.22203410e+00  -9.26515102e-01
  -2.42473096e-01   5.99003017e-01   1.73913467e+00  -1.93858430e-01
  -1.43374527e+00   1.07398760e+00   1.07207060e+00   1.61951423e-01
  -5.40676266e-02   4.17302519e-01   1.00005293e+00   3.77674818e-01
  -3.71740878e-01   3.58445406e-01  -8.24177146e-01  -1.95342794e-01
   1.59818396e-01   1.86507869e+00  -1.02999896e-01   2.35361472e-01
  -8.88520479e-02  -6.55344605e-01  -5.84919631e-01  -1.80438399e+00
  -4.90010023e-01   1.12949932e+00   8.04584026e-01  -5.57008326e-01
   3.20602655e-01  -1.21626444e-02   1.13913751e+00  -2.61323750e-01
   6.04131341e-01  -3.84411216e-01   4.30876583e-01   1.36973023e+00
  -4.52311724e-01  -3.75458837e-01  -1.50622755e-01   2.89720353e-02
  -1.06288576e+00  -6.67449713e-01  -1.29051661e+00   2.89545264e-02
  -1.93420887e-01   1.66177735e-01   1.75877297e+00   1.93062589e-01
  -8.40568900e-01   1.34870625e+00  -1.89256653e-01  -7.85511672e-01
   8.57857391e-02  -8.48629773e-01  -8.74536455e-01  -4.02525246e-01
  -1.52789399e-01  -1.45946229e+00  -4.17044848e-01   1.16633856e+00
  -6.87452674e-01  -2.51601815e-01   9.24120426e-01  -1.28144965e-01
  -2.98476845e-01  -1.16561365e+00   9.29246604e-01  -1.67767084e+00
  -5.68104208e-01   1.06736219e+00  -1.19118094e+00  -3.03120732e-01
  -7.41463304e-01   4.72070873e-01   2.48299551e+00  -2.81263292e-01
   3.67202073e-01  -5.86124837e-01  -1.24790978e+00  -4.07399893e-01
  -2.79536188e-01  -8.91600847e-01  -1.53841388e+00  -1.17691830e-01
  -9.56667602e-01   2.60362685e-01  -4.09198523e-01   2.19347358e-01
  -5.78670949e-02   8.74717355e-01  -1.12379588e-01   1.12117276e-01
  -1.75106406e-01   1.39235690e-01   3.98074538e-01   1.02686846e+00
  -3.06916744e-01  -1.35345984e+00   1.56461429e-02  -1.50991768e-01
  -2.06220955e-01   1.10291207e+00  -8.25287104e-01  -1.45227480e+00
   6.97892308e-01   1.27326667e-01  -2.92763323e-01   1.06978558e-01
  -5.78404665e-01   3.81780118e-01  -3.32058221e-01  -2.55567640e-01
  -1.04397583e+00  -7.61729777e-01  -1.13150513e+00   3.85378487e-02
  -5.59325993e-01   1.02042592e+00   1.39933750e-01  -4.32721823e-01
  -6.84803545e-01   8.08390379e-01   1.49973765e-01  -3.61979336e-01
   1.50900915e-01   2.52624601e-01   1.11986130e-01  -1.02428031e+00
   1.25319934e+00  -2.10718764e-03   4.28461432e-01   5.01111448e-01
  -1.11562926e-02  -5.30013382e-01  -6.90312758e-02  -8.36389232e-03
  -7.11841643e-01   3.13620865e-01   1.19724989e+00   1.05290067e+00
  -1.33844292e+00   1.51336503e+00   6.93252236e-02   7.27280915e-01
   4.62718099e-01   1.65774338e-02   1.14901054e+00   6.81171417e-01
   3.91409844e-01  -4.64155465e-01  -9.91611779e-02  -8.53682816e-01
   3.75461668e-01   8.57320249e-01  -1.36263371e+00   6.31503820e-01
   1.46867484e-01   4.32580024e-01  -9.41742510e-02   2.26151481e-01
  -1.28893822e-01   8.68053827e-03  -7.90321410e-01  -2.95621157e-01
   1.04832202e-01   6.09178543e-02  -4.34291065e-01   1.41637635e+00
  -9.33394954e-02   7.80663311e-01   4.05688375e-01  -4.44582373e-01
  -4.26942796e-01  -9.98405874e-01   4.29689407e-01  -1.14326346e+00
  -4.14442569e-01   1.11963427e+00   2.31696084e-01  -9.33294535e-01
   1.40354514e+00  -4.79793608e-01   1.41210365e+00   5.18216133e-01
   6.22477472e-01   7.99279153e-01  -6.63748384e-01   3.55582893e-01
   3.54039669e-01   1.23876870e+00   1.64995944e+00  -8.33592284e-03
  -5.19801378e-01  -2.57331748e-02   4.64633107e-01   2.92145431e-01
  -3.56417924e-01   1.17264557e+00  -1.52508438e+00  -1.20520569e-01
  -5.02442598e-01   1.48185301e+00   4.27436888e-01  -1.53868258e+00
  -1.08719182e+00   1.33611107e+00   6.60754740e-01  -3.00750166e-01
  -1.16472673e+00   4.68764007e-01   3.32587808e-01  -1.09834325e+00
   6.10835612e-01  -6.76328301e-01  -9.77224231e-01  -8.96418393e-01
  -3.46009672e-01   1.28449082e+00   2.78698169e-02  -1.83980703e+00
  -1.02243817e+00   3.06041330e-01   1.56019643e-01  -1.05990446e+00
   4.90268409e-01   1.66005993e+00   8.44387174e-01  -7.79455066e-01]
knock87
 0.839108
knock88
[('Wales', 0.7803781032562256),
 ('Scotland', 0.7707985043525696),
 ('Britain', 0.6524360179901123),
 ('Ireland', 0.6336396336555481),
 ('London', 0.5997928380966187),
 ('Sweden', 0.5882421731948853),
 ('Spain', 0.587814211845398),
 ('Germany', 0.5737542510032654),
 ('Hampshire', 0.5728317499160767),
 ('Liverpool', 0.5631009340286255)]
knock89
[('Spain', 0.8964061737060547),
 ('Italy', 0.8232440948486328),
 ('Russia', 0.7854013442993164),
 ('Denmark', 0.7810651063919067),
 ('Greece', 0.7806058526039124),
 ('Sweden', 0.7776184678077698),
 ('Austria', 0.774728536605835),
 ('Egypt', 0.7740226984024048),
 ('Portugal', 0.77364581823349),
 ('Germany', 0.769406795501709)]
'''
